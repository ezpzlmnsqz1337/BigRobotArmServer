(function(e){function t(t){for(var s,r,a=t[0],c=t[1],u=t[2],d=0,m=[];d<a.length;d++)r=a[d],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&m.push(i[r][0]),i[r]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(e[s]=c[s]);l&&l(t);while(m.length)m.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],s=!0,a=1;a<n.length;a++){var c=n[a];0!==i[c]&&(s=!1)}s&&(o.splice(t--,1),e=r(r.s=n[0]))}return e}var s={},i={app:0},o=[];function r(t){if(s[t])return s[t].exports;var n=s[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=s,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)r.d(n,s,function(t){return e[t]}.bind(null,s));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=t,a=a.slice();for(var u=0;u<a.length;u++)t(a[u]);var l=c;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},1119:function(e,t,n){},"226f":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d"),n("0cdd");var s=n("2b0e"),i=n("5f5b");n("ab8b"),n("2dd8");s["default"].use(i["a"]);var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},r=[],a=(n("5c0b"),n("2877")),c={},u=Object(a["a"])(c,o,r,!1,null,null,null),l=u.exports,d=n("9483");Object(d["a"])("".concat("/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}});var m=n("8c4f"),f=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-container",{staticClass:"text-center my-auto",staticStyle:{height:"100%"},attrs:{fluid:""}},[n("h1",[e._v("Big Robot Arm UI")]),n("b-row",{directives:[{name:"show",rawName:"v-show",value:!e.isConnected,expression:"!isConnected"}]},[n("b-col",[n("b-button",{attrs:{variant:"success",size:"large"},on:{click:function(t){return e.connect()}}},[e._v("Connect")])],1)],1),n("div",{directives:[{name:"show",rawName:"v-show",value:e.isConnected,expression:"isConnected"}]},[n("b-row",[n("b-col",{staticClass:"p-5"},[n("Model")],1),n("b-col",{staticClass:"p-5"},[n("Terminal")],1)],1),n("b-row",[n("b-col",{staticClass:"p-5"},[n("ManualControl")],1),n("b-col",{staticClass:"p-5"},[n("Sequences")],1)],1),n("b-row",[n("b-col",[n("b-button",{attrs:{variant:"danger",size:"large"},on:{click:function(t){return e.disconnect()}}},[e._v("Disconnect")])],1)],1)],1)],1)},h=[],p=(n("caad"),n("ac1f"),n("2532"),n("1276"),"roborukapi4"),v=!1,b=v?null:new WebSocket("ws://".concat(p,":1337")),g=b,w=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-container",{attrs:{fluid:""}},[n("h2",[e._v("Terminal")]),n("b-row",[n("b-col",{staticClass:"my-auto controls"},[n("b-textarea",{ref:"terminal",staticClass:"__serialOutput",attrs:{readonly:""},model:{value:e.serialOutput,callback:function(t){e.serialOutput=t},expression:"serialOutput"}}),n("b-input-group",[n("b-form-input",{attrs:{placeholder:"Enter command..."},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.sendCommand()}},model:{value:e.command,callback:function(t){e.command=t},expression:"command"}}),n("b-button",{attrs:{disabled:e.disabled},on:{click:function(t){return e.sendCommand()}}},[e._v("Send")]),n("b-button",{attrs:{pressed:e.autoscroll},on:{click:function(t){return e.scrollToBottom()},"update:pressed":function(t){e.autoscroll=t}}},[e._v("Autoscroll")])],1)],1)],1)],1)},S=[],y={name:"Terminal",data:function(){return{disabled:!0,serialOutput:"",command:"",autoscroll:!0}},created:function(){var e=this;this.$root.$on("ws-message-received",(function(t){return e.handleMessage(t)})),this.$root.$on("ws-message-send",(function(t){return e.addMessage(t)}))},methods:{addMessage:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e=t?"Send:\n".concat(e,"\n"):"Receive:\n".concat(e,"\n"),this.serialOutput+=e,this.autoscroll){var n=this.$refs.terminal.$el;setTimeout((function(){return n.scrollTop=n.scrollHeight}))}t&&(this.disabled=!0)},sendCommand:function(){this.command.length&&(g&&g.send("".concat(this.command,"\r")),this.addMessage(this.command),this.command="",this.disabled=!0)},handleMessage:function(e){e.includes("READY")&&(this.disabled=!1),this.addMessage(e,!1)},scrollToBottom:function(){if(this.autoscroll){var e=this.$refs.terminal.$el;setTimeout((function(){return e.scrollTop=e.scrollHeight}))}}}},j=y,x=(n("7af7"),Object(a["a"])(j,w,S,!1,null,"03a76800",null)),$=x.exports,P=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-container",{attrs:{fluid:""}},[n("h2",[e._v("Manual control")]),n("b-row",[n("b-col",{staticClass:"my-auto controls"},e._l(e.joints.concat([e.gripper]),(function(t){return n("b-form-group",{key:t.name},[n("label",{attrs:{for:t.name}},[e._v(e._s(t.name))]),n("b-row",[n("b-col",{attrs:{cols:"2"}},[n("b-form-input",{attrs:{disabled:"",value:t.target}})],1),n("b-col",[n("b-form-input",{attrs:{id:t.name,type:"range",name:t.name,min:t.min,max:t.max},on:{change:function(t){return e.sendCommand()}},model:{value:t.target,callback:function(n){e.$set(t,"target",n)},expression:"j.target"}})],1)],1)],1)})),1)],1),n("b-row",[n("b-col",[n("b-form-group",[n("b-button",{attrs:{size:"large"},on:{click:function(t){return e.setZeroPosition()}}},[e._v("Set zero")]),n("b-button",{attrs:{size:"large"},on:{click:function(t){return e.sendHomeCommand()}}},[e._v("Home")])],1)],1)],1)],1)},W=[],k=(n("99af"),n("4de4"),{name:"ManualControl",data:function(){return{joints:this.$arm.joints,gripper:this.$arm.gripper}},created:function(){var e=this;this.$root.$on("ws-message-received",(function(t){return e.handleMessage(t)}))},methods:{sendCommand:function(){console.log("Pos: ",this.$store.getTargetPositions());var e=this.$store.getTargetPositions(),t=this.$arm.gripper.target,n="G0 B".concat(e.base," S").concat(e.shoulder," E").concat(e.elbow," WR").concat(e.wristRotate," W").concat(e.wrist," G").concat(t);this.$root.$emit("ws-message-send",n),g&&g.send(n)},sendHomeCommand:function(){var e="G28";this.$root.$emit("ws-message-send",e),this.$store.home(),g&&g.send(e)},setZeroPosition:function(){var e="G92";this.$root.$emit("ws-message-send",e),this.$store.home(),g&&g.send(e)},handleMessage:function(e){if(e.includes("B")&&e.includes("S")&&(e=e.split("\n").filter((function(e){return!e.includes("BigRobotArm")})).pop(),e)){var t=this.$store.parsePositionFromCommand(e[1]);this.$store.setTargetPositions(t)}}}}),C=k,_=Object(a["a"])(C,P,W,!1,null,"6297ff88",null),B=_.exports,G=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-container",{attrs:{fluid:""}},[n("h2",[e._v("Sequences")]),n("b-form-group",[n("label",{attrs:{for:"previewSpeed"}},[e._v("Preview speed")]),n("b-form-input",{attrs:{disabled:"",value:e.previewSpeed}}),n("b-form-input",{attrs:{id:"previewSpeed",type:"range",name:"previewSpeed",min:"1",max:"10",step:"1"},on:{change:function(t){return e.setPreviewSpeed()}},model:{value:e.previewSpeed,callback:function(t){e.previewSpeed=t},expression:"previewSpeed"}})],1),n("b-list-group",e._l(e.sequences,(function(t,s){return n("b-list-group-item",{key:"seq-"+s,staticClass:"flex-column align-items-start",attrs:{href:"#",active:s==e.selected},on:{click:function(t){e.selected=s}}},[n("div",{staticClass:"d-flex w-100 justify-content-between"},[n("h5",{staticClass:"mb-1"},[e._v(e._s(t.name))]),n("small",[e._v(e._s(t.data.length)+" commands")])])])})),1),n("b-button",{attrs:{disabled:e.disabled},on:{click:function(t){return e.play()}}},[e._v("Play")]),n("b-button",{on:{click:function(t){return e.preview()}}},[e._v("Preview")])],1)},O=[],E=(n("4160"),n("d81d"),n("159b"),[{name:"Pick up and move",data:["G0 B0 S0 E0 WR0 W0 G40","G0 B0 S2300 E8000 WR0 W2266 G40","G0 B0 S2300 E8000 WR0 W2150 G125","G0 B0 S1000 E8000 WR0 W2150 G125","G0 B-1500 S400 E2700 WR-800 W1000 G125","G0 B-4333 S2200 E8000 WR0 W2266 G125","G0 B-4333 S2200 E8000 WR0 W2266 G40","G0 B0 S0 E0 WR0 W0 G40"]},{name:"Demo",data:["G0 B500 S500 E3000 WR500 W1400 G40","G0 B-700 S2600 E3200 WR-500 W1400 G120","G0 B-1500 S0 E15000 WR0 W0 G100","G0 B2000 S500 E2000 WR800 W2000 G130","G0 B-2000 S2500 E-10250 WR0 W2000 G40"]},{name:"TestShoulder",data:["G0 B0 S0 E0 WR0 W0 G40","G0 B0 S2500 E0 WR0 W0 G40","G0 B0 S0 E0 WR0 W0 G40","G0 B0 S1500 E0 WR0 W0 G40","G0 B0 S0 E0 WR0 W0 G40"]}]),R=n("d4ec"),M=n("262e"),A=n("2caf"),T=n("faa1"),N=n.n(T),I=function(e){Object(M["a"])(n,e);var t=Object(A["a"])(n);function n(){return Object(R["a"])(this,n),t.apply(this,arguments)}return n}(N.a),F=new I;F.setMaxListeners(100);var q=F,D={name:"Sequences",data:function(){return{sequences:E,selected:0,disabled:!0,joints:this.$arm.joints,gripper:this.$arm.gripper,previewQueue:[],previewSpeed:1}},created:function(){var e=this;this.$root.$on("ws-message-received",(function(t){return e.handleMessage(t)})),q.on("inPosition",(function(){return e.previewCommand(e.previewQueue.shift())}))},methods:{play:function(){var e=this,t=this.sequences[this.selected].data;t.forEach((function(t){return e.sendCommand(t)})),this.disabled=!0},preview:function(){this.previewQueue=this.sequences[this.selected].data.map((function(e){return e})),this.previewCommand(this.previewQueue.shift())},previewCommand:function(e){if(e){var t=this.$store.parsePositionFromCommand(e);this.$store.setTargetPositions(t)}},sendCommand:function(e){g&&g.send(e)},handleMessage:function(e){e.includes("READY")&&(this.disabled=!1)},setPreviewSpeed:function(){q.emit("setPreviewSpeed",parseFloat(this.previewSpeed)/1e3)}}},J=D,z=(n("ea3d"),Object(a["a"])(J,G,O,!1,null,"5b287770",null)),H=z.exports,Q=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-container",{attrs:{fluid:""}},[n("h2",[e._v("Model")]),n("b-row",[n("b-col",{staticClass:"my-auto controls"},[n("div",{ref:"armWrapper",staticClass:"__armWrapper"})])],1)],1)},Y=[],Z=(n("7db0"),n("13d5"),n("b0c0"),n("b680"),n("07ac"),n("bee2")),L=n("5a89"),U=n("ef20"),K=n("34ad"),V=n("4721"),X=1.5,ee=function(){function e(t,n){Object(R["a"])(this,e),this.el=t,this.scene=null,this.camera=null,this.renderer=null,this.stats=null,this.controls=null,this.inPosition=n.joints.reduce((function(e,t){return e[t.name]=!0,e}),{}),this.firedInPosition=!1,this.previewSpeed=.005,this.arm=n}return Object(Z["a"])(e,[{key:"init",value:function(){var e=this;this.setupScene(),this.setupControls(),this.setupStats(),this.loadModel(),this.animate(),q.on("setPreviewSpeed",(function(t){return e.previewSpeed=t}))}},{key:"animate",value:function(){var e=this;requestAnimationFrame(this.animate.bind(this)),this.arm.joints.forEach((function(t){return e.handleJoint(t)})),this.renderer.render(this.scene,this.camera)}},{key:"handleJoint",value:function(e){if(e.mesh){var t=e.rotationAxis,n=parseFloat(e.mesh.rotation[t].toFixed(2)),s=this.mapAngle(e.target,e.min,e.max,-X,X);e.inverted&&(s*=-1),n===s?this.inPosition[e.name]=!0:n<s?(this.inPosition[e.name]=!1,e.mesh.rotation[t]+=this.previewSpeed):n>s&&(this.inPosition[e.name]=!1,e.mesh.rotation[t]-=this.previewSpeed)}this.isInPosition()?this.firedInPosition||(q.emit("inPosition"),this.firedInPosition=!0):this.firedInPosition=!1}},{key:"isInPosition",value:function(){return!Object.values(this.inPosition).includes(!1)}},{key:"mapAngle",value:function(e,t,n,s,i){return parseFloat(((e-t)*(i-s)/(n-t)+s).toFixed(2))}},{key:"setupScene",value:function(){this.scene=new L["cb"],this.camera=new L["T"](75,this.el.offsetWidth/this.el.offsetHeight,.1,1e3),this.renderer=new L["qb"],this.renderer.setSize(this.el.offsetWidth,this.el.offsetHeight),this.el.appendChild(this.renderer.domElement);var e=new L["a"](4210752);e.intensity=3,this.scene.background=new L["i"](14540253),this.scene.add(e),this.camera.position.x=1,this.camera.position.y=1,this.camera.position.z=.5}},{key:"setupStats",value:function(){this.stats=new U["a"],this.stats.dom.height="48px"}},{key:"setupControls",value:function(){this.controls=new V["a"](this.camera,this.renderer.domElement),this.controls.autoRotate=!1,this.controls.autoRotateSpeed=-10,this.controls.screenSpacePanning=!0}},{key:"loadModel",value:function(){var e=this,t=new K["a"];t.load(n("989d"),(function(t){e.scene.add(t.scene),t.scene.name="BigRobotArm",e.setupShafts(),e.centerCamera()}),void 0,(function(e){console.error(e)}))}},{key:"centerCamera",value:function(){var e=this.scene.getObjectByName("BigRobotArm"),t=new L["ob"];(new L["d"]).setFromObject(e).getCenter(t),this.camera.lookAt(t),console.log(e)}},{key:"setupShafts",value:function(){this.arm.joints.find((function(e){return"base"===e.name})).mesh=this.scene.getObjectByName("ShaftBase"),this.arm.joints.find((function(e){return"shoulder"===e.name})).mesh=this.scene.getObjectByName("ShaftShoulder"),this.arm.joints.find((function(e){return"elbow"===e.name})).mesh=this.scene.getObjectByName("ShaftElbow"),this.arm.joints.find((function(e){return"wristRotate"===e.name})).mesh=this.scene.getObjectByName("ShaftWristRotate"),this.arm.joints.find((function(e){return"wrist"===e.name})).mesh=this.scene.getObjectByName("ShaftWrist")}},{key:"setPosition",value:function(){}}]),e}(),te={name:"Model",data:function(){return{arm:null,joints:this.$arm.joints}},created:function(){var e=this;this.$root.$on("ws-message-received",(function(t){return e.handleMessage(t)}))},mounted:function(){var e=this.$refs.armWrapper;this.arm=new ee(e,this.$arm),this.arm.init()},methods:{handleMessage:function(e){e.includes("READY")&&(this.disabled=!1)}}},ne=te,se=(n("fd70"),Object(a["a"])(ne,Q,Y,!1,null,"47dc7162",null)),ie=se.exports,oe={name:"Main",components:{ManualControl:B,Terminal:$,Sequences:H,Model:ie},data:function(){return{connectionStatus:1}},computed:{isConnected:function(){return 1==this.connectionStatus}},created:function(){var e=this;g&&(g.onopen=function(){g&&g.send("connected")},g.onmessage=function(t){console.log("Response from server: ",t.data),t.data.includes("connectionStatus")&&(e.connectionStatus=parseInt(t.data.split(":")[1])),e.$root.$emit("ws-message-received",t.data)})},methods:{connect:function(){g&&g.send("connect")},disconnect:function(){g&&g.send("disconnect")}}},re=oe,ae=Object(a["a"])(re,f,h,!1,null,null,null),ce=ae.exports;s["default"].use(m["a"]);var ue=[{path:"/",name:"Main",component:ce}],le=new m["a"]({mode:"history",base:"/",routes:ue}),de=le,me=-6500,fe=6500,he=6500/90,pe=-2500,ve=2500,be=2500/90,ge=-1e4,we=1e4,Se=1e4/90,ye=-2e3,je=2e3,xe=2e3/90,$e=-3e3,Pe=3e3,We=3e3/90,ke=40,Ce=125,_e=s["default"].observable({state:{arm:{joints:[{name:"base",position:0,target:0,min:me,max:fe,stepsPerDegree:he,mesh:null,inverted:!0,rotationAxis:"y"},{name:"shoulder",position:0,target:0,min:pe,max:ve,stepsPerDegree:be,mesh:null,inverted:!1,rotationAxis:"x"},{name:"elbow",position:0,target:0,min:ge,max:we,stepsPerDegree:Se,mesh:null,inverted:!1,rotationAxis:"x"},{name:"wristRotate",position:0,target:0,min:ye,max:je,stepsPerDegree:xe,mesh:null,inverted:!1,rotationAxis:"y"},{name:"wrist",position:0,target:0,min:$e,max:Pe,stepsPerDegree:We,mesh:null,inverted:!0,rotationAxis:"x"}],gripper:{name:"gripper",position:0,target:0,min:ke,max:Ce,mesh:null}}},home:function(){this.state.arm.joints.forEach((function(e){return e.target=0})),this.state.arm.gripper.target=ke},getTargetPositions:function(){return this.state.arm.joints.reduce((function(e,t){return e[t.name]=parseFloat(t.target),e}),{})},setTargetPositions:function(e){this.getJointByName("base").target=e[0].value,this.getJointByName("shoulder").target=e[1].value,this.getJointByName("elbow").target=e[2].value,this.getJointByName("wristRotate").target=e[3].value,this.getJointByName("wrist").target=e[4].value,this.state.arm.gripper.target=e[5].value},getJointByName:function(e){return this.state.arm.joints.find((function(t){return t.name===e}))},parsePositionFromCommand:function(e){e=e.split(" ");var t=[{name:"base",value:parseInt(e[1].substring(1))},{name:"shoulder",value:parseInt(e[2].substring(1))},{name:"elbow",value:parseInt(e[3].substring(1))},{name:"wristRotate",value:parseInt(e[4].substring(2))},{name:"wrist",value:parseInt(e[5].substring(1))},{name:"gripper",value:parseInt(e[6].substring(1))}];return t}});s["default"].config.productionTip=!1,s["default"].prototype.$store=_e,s["default"].prototype.$arm=_e.state.arm,new s["default"]({router:de,render:function(e){return e(l)}}).$mount("#app")},"5c0b":function(e,t,n){"use strict";var s=n("9c0c"),i=n.n(s);i.a},"7af7":function(e,t,n){"use strict";var s=n("226f"),i=n.n(s);i.a},9093:function(e,t,n){},"989d":function(e,t,n){e.exports=n.p+"9f3540090835cf669d16879466d90796.glb"},"9c0c":function(e,t,n){},ea3d:function(e,t,n){"use strict";var s=n("9093"),i=n.n(s);i.a},fd70:function(e,t,n){"use strict";var s=n("1119"),i=n.n(s);i.a}});
//# sourceMappingURL=app.9f2c879d.js.map